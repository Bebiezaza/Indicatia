plugins {
    id "fabric-loom" version "0.2.2-SNAPSHOT"
    id "maven-publish"
    id "com.matthewprenger.cursegradle" version "1.1.2"
}

def api = new groovy.json.JsonSlurper().parseText(file("${api_token_path}").text)
def mcVersion = project.mc_version
def version = project.version
def hasInternal = project.hasProperty("internal")

apply plugin: net.fabricmc.loom.LoomGradlePlugin
archivesBaseName = "Indicatia"
sourceCompatibility = targetCompatibility = 1.8

minecraft {
}

repositories {
    // Curse Gradle
    maven {
        url "https://plugins.gradle.org/m2/"
    }
    // Cloth
    maven {
        url "https://minecraft.curseforge.com/api/maven"
    }
    // CottonMC
    maven {
        url "http://server.bbkr.space:8081/artifactory/libs-snapshot"
    }
}

jar {
    baseName = "Indicatia-" + mcVersion
}

dependencies {
	minecraft "com.mojang:minecraft:1.14.1 Pre-Release 2"
    mappings "net.fabricmc:yarn:1.14.1 Pre-Release 2+build.+"
    modCompile "net.fabricmc:fabric-loader:0.4.7+build.+"

    // Fabric API. This is technically optional, but you probably want it anyway.
    modCompile "net.fabricmc:fabric:0.2.7+build.127"

    modCompile "cloth-config:ClothConfig:0.2.1.14"
    modCompile "io.github.prospector.modmenu:ModMenu:1.5.3-84"
    modCompile "io.github.cottonmc:client-commands:0.2.1+1.14-pre5-SNAPSHOT"
    //modCompile files("libs/SteveKunG's-Lib-1.14-1.0.0-dev.jar")
}

curseforge {
    apiKey = api.indicatia
    project {
        id = "272146"
        changelog = ""
        changelogType = "markdown"
        releaseType = "beta"
        addGameVersion mcVersion

        mainArtifact(file("build/libs/Indicatia-" + mcVersion + "-" + version + ".jar")) {
            displayName = "Indicatia-" + mcVersion + "-" + version
            relations {
                requiredLibrary "stevekungs-lib"
            }
        }
    }
}